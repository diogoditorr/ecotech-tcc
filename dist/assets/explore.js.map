{"version":3,"file":"explore.js","sources":["../../public/scripts/classes/explore-favorite-button.ts","../../public/scripts/classes/modal.ts","../../public/scripts/classes/part.ts","../../public/scripts/explore.ts"],"sourcesContent":["import FavoriteButton, { IMessageOptions } from \"./favorite-button\";\nimport Part from \"./part\";\n\nexport default class ExploreFavoriteButton extends FavoriteButton {\n    part: Part;\n\n    constructor(part: Part, button: HTMLButtonElement, isFavorited: boolean, message?: IMessageOptions) {\n        super(button, isFavorited, message);\n        this.part = part;\n    }\n\n    toggleFavorite(): void {\n        this.disableButton();\n        if (this.part.favoriteButton !== this) {\n            this.part.favoriteButton.disableButton();\n        }\n\n        // Send request to add to favorites\n        fetch(\"../../src/php/favorite-part.php\", {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json;charset=utf-8\",\n            },\n            body: JSON.stringify({\n                partId: this.part.id,\n            }),\n        })\n            .then((response) => {\n                setTimeout(() => {\n                    if (response.status === 200) {\n                        const status = !this.isFavorited;\n\n                        this.setFavorite(status);\n                        if (this.part.favoriteButton !== this) {\n                            this.part.favoriteButton.setFavorite(status);\n                        }\n\n                        this.enableButton();\n                        if (this.part.favoriteButton !== this) {\n                            this.part.favoriteButton.enableButton();\n                        }\n\n                        this.updatePart();\n\n                        this.updateButtonDataset();\n                        if (this.part.favoriteButton !== this) {\n                            this.part.favoriteButton.updateButtonDataset();\n                        }\n\n                        this.updateText();\n\n                        if (\n                            this.part.favoriteButton !== this &&\n                            this.part.favoriteButton.message !== undefined\n                        ) {\n                            this.part.favoriteButton.updateText();\n                        }\n                    }\n                }, 1000);\n            })\n            .catch((error) => {\n                this.enableButton();\n                console.log(error);\n            });\n    }\n\n    updatePart() {\n        this.part.setFavorite(this.isFavorited);\n    }\n}","import ExploreFavoriteButton from \"./explore-favorite-button\";\nimport Part from \"./part\";\n\nexport default class Modal {\n    part: Part;\n    page: HTMLElement;\n    modal: HTMLElement;\n    modalContent: HTMLElement;\n    modalSkeletonTemplate: HTMLElement;\n\n    constructor(part: Part) {\n        this.part = part;\n        this.page = document.querySelector(\"#page-explore\") as HTMLElement;\n        this.modal = document.querySelector(\"#modal\") as HTMLElement;\n        this.modalContent = document.querySelector(\"#modal .content\") as HTMLElement;\n        this.modalSkeletonTemplate = document.getElementById(\n            \"modal-skeleton-template\"\n        ) as HTMLElement;\n\n        const close = document.querySelector(\"#modal .close\") as HTMLElement;\n        close.addEventListener(\"click\", this.closeModal.bind(this));\n    }\n\n    static create(part: Part) {\n        const modal = new Modal(part);\n        modal.openModal();\n        modal.loadData();\n    }\n\n    openModal() {\n        this.modal.classList.remove(\"hide\");\n        this.page.classList.add(\"blur\");\n    }\n\n    closeModal() {\n        this.modal.classList.add(\"hide\");\n        this.page.classList.remove(\"blur\");\n        this.modalContent.innerHTML = \"\";\n    }\n\n    loadData() {\n        this.modalContent.innerHTML = this.modalSkeletonTemplate.innerHTML;\n\n        fetch(\"../../src/php/get-part-details.php\", {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json;charset=utf-8\",\n            },\n            body: JSON.stringify({\n                partId: this.part.id,\n            }),\n        })\n            .then((response) => response.json())\n            .then((data) => {\n                const defaultStorage = \"../../storage/parts/\";\n                console.log(data);\n                this.modalContent.innerHTML = `\n                    <div class=\"left\">\n                        <section>\n                            <div class=\"image\">\n                                <img src=\"${\n                                    defaultStorage + data.part.image\n                                }\" alt=\"\">\n                            </div>\n                            <div class=\"name\">${data.part.name}</div>\n                            <div class=\"stock\">\n                                <span>Estoque:</span>\n                                <div class=\"amount\">${\n                                    data.part.stock\n                                } unidades</div>\n                            </div>\n                        </section>\n    \n                        <div class=\"button-wrapper\">\n                            <button class=\"favorite\">\n                                <svg width=\"24\" height=\"22\" viewBox=\"0 0 24 22\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"white\">\n                                    <path d=\"M21.4875 2.01407C18.7781 -0.264057 14.5922 0.07813 12 2.71719C9.40782 0.07813 5.22188 -0.268745 2.51251 2.01407C-1.01249 4.98125 -0.49687 9.81875 2.01563 12.3828L10.2375 20.7594C10.7063 21.2375 11.3344 21.5047 12 21.5047C12.6703 21.5047 13.2938 21.2422 13.7625 20.7641L21.9844 12.3875C24.4922 9.82344 25.0172 4.98594 21.4875 2.01407ZM20.3813 10.8031L12.1594 19.1797C12.0469 19.2922 11.9531 19.2922 11.8406 19.1797L3.61876 10.8031C1.90782 9.05938 1.56094 5.75938 3.96094 3.73907C5.78438 2.20625 8.59688 2.43594 10.3594 4.23125L12 5.90469L13.6406 4.23125C15.4125 2.42657 18.225 2.20625 20.0391 3.73438C22.4344 5.75469 22.0781 9.07344 20.3813 10.8031Z\"/>\n                                </svg>\n                                <svg width=\"512\" height=\"449\" viewBox=\"0 0 512 449\" fill=\"black\" xmlns=\"http://www.w3.org/2000/svg\">\n                                    <path d=\"M462.3 31.6C407.5 -15.1 326 -6.7 275.7 45.2L256 65.5L236.3 45.2C186.1 -6.7 104.5 -15.1 49.6996 31.6C-13.1004 85.2 -16.4004 181.4 39.7996 239.5L233.3 439.3C245.8 452.2 266.1 452.2 278.6 439.3L472.1 239.5C528.4 181.4 525.1 85.2 462.3 31.6V31.6Z\" />\n                                </svg>\n                                <span></span>\n                            </button>\n                        </div>\n                    </div>\n            \n                    <div class=\"right\">\n                        <section>\n                            <div class=\"field\">\n                                <h2>Tipo:</h2>\n                                <p>${data.part.type}</p>\n                            </div>\n            \n                            <div class=\"field\">\n                                <h2>Modelo:</h2>\n                                <p>${data.part.model}</p>\n                            </div>\n                            \n                            <div class=\"field\">\n                                <h2>Sobre:</h2>\n                                <p>${data.part.description}</p>\n                            </div>\n            \n                            <div class=\"field\">\n                                <h2>Contato:</h2>\n                                <p>\n                                    N√ÉO IMPLEMENTADO!!! <br>\n                                    ${data.part.person.address.city} - \n                                    ${data.part.person.address.state}\n                                </p>\n                                <p>\n                                    Telefone:<br> \n                                    ${data.part.person.phoneNumber1}<br>\n                                    ${data.part.person.phoneNumber2}\n                                </p>\n                            </div>\n                        </section>\n            \n                        <div class=\"button-wrapper\">\n                            <form action=\"../../src/php/make-order.php\" method=\"post\">\n                                <input type=\"hidden\" name=\"partId\" value=\"${\n                                    data.part.id\n                                }\">\n                                <input type=\"hidden\" name=\"doadorId\" value=\"${\n                                    data.part.person.id\n                                }\">\n                                <button class=\"order\">\n                                    <span>Fazer Pedido</span>\n                                </button>\n                            </form>\n                        </div>\n                    </div>\n                `;\n\n                new ExploreFavoriteButton(\n                    this.part,\n                    this.modalContent.querySelector(\".left button.favorite\") as HTMLButtonElement,\n                    this.part.isFavorited,\n                    {\n                        favorited: \"Remover\",\n                        notFavorited: \"Tenho Interesse\",\n                    }\n                );\n            })\n            .catch((error) => {\n                console.log(error);\n            });\n    }\n}\n","import Modal from './modal.js';\nimport ExploreFavoriteButton from './explore-favorite-button.js';\n\nexport default class Part {\n    element: HTMLDivElement;\n    id: number;\n    isFavorited: boolean;\n    favoriteButton: ExploreFavoriteButton;\n\n    constructor(part: HTMLDivElement) {\n        const seeDetailsButton = part.querySelector(\".see-details\") as HTMLButtonElement;\n        const favoriteButton = part.querySelector(\".favorite\") as HTMLButtonElement;\n\n        this.element = part\n        this.id = Number(part.getAttribute(\"data-id\"));\n        this.isFavorited = favoriteButton.getAttribute(\"data-is-favorited\") === \"true\";\n        this.favoriteButton = new ExploreFavoriteButton(this, favoriteButton, this.isFavorited)\n        \n        seeDetailsButton.addEventListener(\"click\", Modal.create.bind(null, this));\n    }\n\n    setFavorite(value: boolean) {\n        this.isFavorited = value;\n    }\n}","import Part from './classes/part';\n\nconst parts = document.querySelectorAll<HTMLDivElement>(\"#page-explore .part\");\n\nparts.forEach((part) => {\n    new Part(part);\n});\n"],"names":[],"mappings":"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"}