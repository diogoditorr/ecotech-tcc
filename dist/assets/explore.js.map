{"version":3,"file":"explore.js","sources":["../../public/scripts/classes/favorite-button.ts","../../public/scripts/classes/modal.ts","../../public/scripts/classes/part.ts","../../public/scripts/explore.ts"],"sourcesContent":["import Part from \"./part\";\n\ninterface MessageOptions {\n    favorited: string;\n    notFavorited: string;\n}\n\nexport default class FavoriteButton {\n    part: Part;\n    button: HTMLButtonElement;\n    isFavorited: boolean;\n    message?: MessageOptions;\n    span?: HTMLSpanElement | null;\n    \n    constructor(part: Part, button: HTMLButtonElement, isFavorited: boolean, message?: MessageOptions) {\n        this.part = part;\n        this.button = button;\n        this.button.addEventListener(\"click\", this.toggleFavorite.bind(this));\n        this.isFavorited = isFavorited;\n\n        this.updateButtonDataset();\n\n        if (message) {\n            this.message = message;\n            this.span = this.button.querySelector(\"span\");\n            this.updateText();\n        }\n    }\n\n    toggleFavorite() {\n        this.disableButton();\n        if (this.part.favoriteButton !== this) {\n            this.part.favoriteButton.disableButton();\n        }\n\n        // Send request to add to favorites\n        fetch(\"../../src/php/favorite-part.php\", {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json;charset=utf-8\",\n            },\n            body: JSON.stringify({\n                partId: this.part.id,\n            }),\n        })\n            .then((response) => {\n                setTimeout(() => {\n                    if (response.status === 200) {\n                        const status = !this.isFavorited;\n\n                        this.setFavorite(status);\n                        if (this.part.favoriteButton !== this) {\n                            this.part.favoriteButton.setFavorite(status);\n                        }\n\n                        this.enableButton();\n                        if (this.part.favoriteButton !== this) {\n                            this.part.favoriteButton.enableButton();\n                        }\n\n                        this.updatePart();\n\n                        this.updateButtonDataset();\n                        if (this.part.favoriteButton !== this) {\n                            this.part.favoriteButton.updateButtonDataset();\n                        }\n\n                        this.updateText();\n\n                        if (\n                            this.part.favoriteButton !== this &&\n                            this.part.favoriteButton.message !== undefined\n                        ) {\n                            this.part.favoriteButton.updateText();\n                        }\n                    }\n                }, 1000);\n            })\n            .catch((error) => {\n                this.enableButton();\n                console.log(error);\n            });\n    }\n\n    enableButton() {\n        this.button.disabled = false;\n        this.button.classList.remove(\"disabled\");\n    }\n\n    disableButton() {\n        this.button.disabled = true;\n        this.button.classList.add(\"disabled\");\n    }\n\n    setFavorite(value: boolean) {\n        this.isFavorited = value;\n    }\n\n    updateButtonDataset() {\n        this.button.setAttribute(\"data-is-favorited\", this.isFavorited.toString());\n    }\n\n    updateText() {\n        if (!this.span || !this.message)\n            return\n\n        this.span.textContent = this.isFavorited\n            ? this.message.favorited\n            : this.message.notFavorited;\n    }\n\n    updatePart() {\n        this.part.setFavorite(this.isFavorited);\n    }\n}\n","import FavoriteButton from \"./favorite-button\";\nimport Part from \"./part\";\n\nexport default class Modal {\n    part: Part;\n    page: HTMLElement;\n    modal: HTMLElement;\n    modalContent: HTMLElement;\n    modalSkeletonTemplate: HTMLElement;\n\n    constructor(part: Part) {\n        this.part = part;\n        this.page = document.querySelector(\"#page-explore\") as HTMLElement;\n        this.modal = document.querySelector(\"#modal\") as HTMLElement;\n        this.modalContent = document.querySelector(\"#modal .content\") as HTMLElement;\n        this.modalSkeletonTemplate = document.getElementById(\n            \"modal-skeleton-template\"\n        ) as HTMLElement;\n\n        const close = document.querySelector(\"#modal .close\") as HTMLElement;\n        close.addEventListener(\"click\", this.closeModal.bind(this));\n    }\n\n    static create(part: Part) {\n        const modal = new Modal(part);\n        modal.openModal();\n        modal.loadData();\n    }\n\n    openModal() {\n        this.modal.classList.remove(\"hide\");\n        this.page.classList.add(\"blur\");\n    }\n\n    closeModal() {\n        this.modal.classList.add(\"hide\");\n        this.page.classList.remove(\"blur\");\n        this.modalContent.innerHTML = \"\";\n    }\n\n    loadData() {\n        this.modalContent.innerHTML = this.modalSkeletonTemplate.innerHTML;\n\n        fetch(\"../../src/php/get-part-details.php\", {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json;charset=utf-8\",\n            },\n            body: JSON.stringify({\n                partId: this.part.id,\n            }),\n        })\n            .then((response) => response.json())\n            .then((data) => {\n                const defaultStorage = \"../../storage/parts/\";\n                console.log(data);\n                this.modalContent.innerHTML = `\n                    <div class=\"left\">\n                        <section>\n                            <div class=\"image\">\n                                <img src=\"${\n                                    defaultStorage + data.part.image\n                                }\" alt=\"\">\n                            </div>\n                            <div class=\"name\">${data.part.name}</div>\n                            <div class=\"stock\">\n                                <span>Estoque:</span>\n                                <div class=\"amount\">${\n                                    data.part.stock\n                                } unidades</div>\n                            </div>\n                        </section>\n    \n                        <div class=\"button-wrapper\">\n                            <button class=\"favorite\">\n                                <img src=\"../../public/assets/heart.svg\" alt=\"\">\n                                <img src=\"../../public/assets/heart-filled.svg\" alt=\"\">\n                                <span></span>\n                            </button>\n                        </div>\n                    </div>\n            \n                    <div class=\"right\">\n                        <section>\n                            <div class=\"field\">\n                                <h2>Tipo:</h2>\n                                <p>${data.part.type}</p>\n                            </div>\n            \n                            <div class=\"field\">\n                                <h2>Modelo:</h2>\n                                <p>${data.part.model}</p>\n                            </div>\n                            \n                            <div class=\"field\">\n                                <h2>Sobre:</h2>\n                                <p>${data.part.description}</p>\n                            </div>\n            \n                            <div class=\"field\">\n                                <h2>Contato:</h2>\n                                <p>\n                                    N√ÉO IMPLEMENTADO!!! <br>\n                                    ${data.part.person.address.city} - \n                                    ${data.part.person.address.state}\n                                </p>\n                                <p>\n                                    Telefone:<br> \n                                    ${data.part.person.phoneNumber1}<br>\n                                    ${data.part.person.phoneNumber2}\n                                </p>\n                            </div>\n                        </section>\n            \n                        <div class=\"button-wrapper\">\n                            <form action=\"../../src/php/make-order.php\" method=\"post\">\n                                <input type=\"hidden\" name=\"partId\" value=\"${\n                                    data.part.id\n                                }\">\n                                <input type=\"hidden\" name=\"doadorId\" value=\"${\n                                    data.part.person.id\n                                }\">\n                                <button class=\"order\">\n                                    <span>Fazer Pedido</span>\n                                </button>\n                            </form>\n                        </div>\n                    </div>\n                `;\n\n                new FavoriteButton(\n                    this.part,\n                    this.modalContent.querySelector(\".left button.favorite\") as HTMLButtonElement,\n                    this.part.isFavorited,\n                    {\n                        favorited: \"Remover\",\n                        notFavorited: \"Tenho Interesse\",\n                    }\n                );\n            })\n            .catch((error) => {\n                console.log(error);\n            });\n    }\n}\n","import Modal from './modal.js';\nimport FavoriteButton from './favorite-button.js';\n\nexport default class Part {\n    element: HTMLDivElement;\n    id: number;\n    isFavorited: boolean;\n    favoriteButton: FavoriteButton;\n\n    constructor(part: HTMLDivElement) {\n        const seeDetailsButton = part.querySelector(\".see-details\") as HTMLButtonElement;\n        const favoriteButton = part.querySelector(\".favorite\") as HTMLButtonElement;\n\n        this.element = part\n        this.id = Number(part.getAttribute(\"data-id\"));\n        this.isFavorited = favoriteButton.getAttribute(\"data-is-favorited\") === \"true\";\n        this.favoriteButton = new FavoriteButton(this, favoriteButton, this.isFavorited)\n        \n        seeDetailsButton.addEventListener(\"click\", Modal.create.bind(null, this));\n    }\n\n    setFavorite(value: boolean) {\n        this.isFavorited = value;\n    }\n}","// import FavoriteButton from './classes/favorite-button.js';\nimport Part from './classes/part';\n\nconst parts = document.querySelectorAll<HTMLDivElement>(\"#page-explore .part\");\n\nparts.forEach((part) => {\n    new Part(part);\n});\n"],"names":[],"mappings":"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"}