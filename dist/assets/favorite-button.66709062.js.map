{"version":3,"file":"favorite-button.66709062.js","sources":["../../public/scripts/classes/favorite-button.ts"],"sourcesContent":["export interface IMessageOptions {\n    favorited: string;\n    notFavorited: string;\n}\n\nexport default class FavoriteButton {\n    button: HTMLButtonElement;\n    isFavorited: boolean;\n    message?: IMessageOptions;\n    span?: HTMLSpanElement | null;\n    \n    constructor(button: HTMLButtonElement, isFavorited: boolean, message?: IMessageOptions) {\n        this.button = button;\n        this.button.addEventListener(\"click\", this.toggleFavorite.bind(this));\n        this.isFavorited = isFavorited;\n\n        this.updateButtonDataset();\n\n        if (message) {\n            this.message = message;\n            this.span = this.button.querySelector(\"span\");\n            this.updateText();\n        }\n    }\n\n    toggleFavorite() {\n        this.disableButton();\n\n        // Send request to add to favorites\n        fetch(\"../../src/php/favorite-part.php\", {\n            method: \"POST\",\n            headers: {\n                \"Content-Type\": \"application/json;charset=utf-8\",\n            },\n            body: JSON.stringify({\n                // Get part id as \"peca_id\" from query params\n                partId: Number(new URLSearchParams(window.location.search).get(\"peca_id\")),\n            }),\n        })\n            .then((response) => {\n                setTimeout(() => {\n                    if (response.status === 200) {\n                        const status = !this.isFavorited;\n                        this.setFavorite(status);\n                        this.enableButton();\n                        this.updateButtonDataset();\n                        this.updateText();\n                    }\n                }, 1000);\n            })\n            .catch((error) => {\n                this.enableButton();\n                console.log(error);\n            });\n    }\n\n    enableButton() {\n        this.button.disabled = false;\n        this.button.classList.remove(\"disabled\");\n    }\n\n    disableButton() {\n        this.button.disabled = true;\n        this.button.classList.add(\"disabled\");\n    }\n\n    setFavorite(value: boolean) {\n        this.isFavorited = value;\n    }\n\n    updateButtonDataset() {\n        this.button.setAttribute(\"data-is-favorited\", this.isFavorited.toString());\n    }\n\n    updateText() {\n        if (!this.span || !this.message)\n            return\n\n        this.span.textContent = this.isFavorited\n            ? this.message.favorited\n            : this.message.notFavorited;\n    }\n\n}\n"],"names":[],"mappings":"+KAKoC,CAMhC,YAAY,EAA2B,EAAsB,EAA2B,CALxF,iBACA,sBACA,kBACA,oBAGS,OAAS,OACT,OAAO,iBAAiB,QAAS,KAAK,eAAe,KAAK,YAC1D,YAAc,OAEd,sBAED,SACK,QAAU,OACV,KAAO,KAAK,OAAO,cAAc,aACjC,cAIb,gBAAiB,MACR,sBAGC,kCAAmC,CACrC,OAAQ,OACR,QAAS,CACL,eAAgB,kCAEpB,KAAM,KAAK,UAAU,CAEjB,OAAQ,OAAO,GAAI,iBAAgB,OAAO,SAAS,QAAQ,IAAI,gBAGlE,KAAK,AAAC,GAAa,YACL,IAAM,IACT,EAAS,SAAW,IAAK,MACnB,GAAS,CAAC,KAAK,iBAChB,YAAY,QACZ,oBACA,2BACA,eAEV,OAEN,MAAM,AAAC,GAAU,MACT,uBACG,IAAI,KAIxB,cAAe,MACN,OAAO,SAAW,QAClB,OAAO,UAAU,OAAO,YAGjC,eAAgB,MACP,OAAO,SAAW,QAClB,OAAO,UAAU,IAAI,YAG9B,YAAY,EAAgB,MACnB,YAAc,EAGvB,qBAAsB,MACb,OAAO,aAAa,oBAAqB,KAAK,YAAY,YAGnE,YAAa,CACL,CAAC,KAAK,MAAQ,CAAC,KAAK,eAGnB,KAAK,YAAc,KAAK,YACvB,KAAK,QAAQ,UACb,KAAK,QAAQ"}